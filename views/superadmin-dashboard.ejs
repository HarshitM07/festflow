<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Super Admin Dashboard - FestFlow</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-900 text-gray-100 min-h-screen font-sans">

  <header class="border-b border-gray-800 bg-gray-950">
    <div class="max-w-6xl mx-auto px-4 py-4 flex items-center justify-between">
      <h1 class="text-2xl font-bold">Super Admin Dashboard</h1>
      <div class="flex items-center gap-4">
        <% if (currentUser) { %>
          <div class="text-sm text-gray-300">
            <div><span class="font-semibold"><%= currentUser.role %></span></div>
          </div>
        <% } %>
        <form action="/logout" method="POST">
          <button class="px-3 py-1 rounded bg-red-600 hover:bg-red-700 text-sm font-semibold">
            Logout
          </button>
        </form>
      </div>
    </div>
  </header>

  <main class="max-w-6xl mx-auto px-4 py-8 space-y-8">

    <!-- Summary cards -->
    <section class="grid grid-cols-1 sm:grid-cols-3 gap-4">
      <div class="bg-gray-800 rounded-xl p-4 border border-gray-700">
        <div class="text-sm text-gray-400 mb-1">Total Clubs</div>
        <div class="text-3xl font-bold"><%= clubs ? clubs.length : 0 %></div>
      </div>
      <div class="bg-gray-800 rounded-xl p-4 border border-gray-700">
        <div class="text-sm text-gray-400 mb-1">Coordinators</div>
        <div class="text-3xl font-bold"><%= coordinators ? coordinators.length : 0 %></div>
      </div>
      <div class="bg-gray-800 rounded-xl p-4 border border-gray-700">
        <div class="text-sm text-gray-400 mb-1">Approved Clubs</div>
        <div class="text-3xl font-bold">
          <%= clubs ? clubs.filter(c => c.isApproved).length : 0 %>
        </div>
      </div>
    </section>

    <!-- Club list and coordinator list -->
    <section class="grid grid-cols-1 lg:grid-cols-2 gap-8">

      <!-- Clubs table -->
      <div class="bg-gray-900 border border-gray-800 rounded-xl p-4">
        <div class="flex items-center justify-between mb-3">
          <h2 class="text-xl font-semibold">Clubs</h2>
        </div>
        <div class="overflow-x-auto">
          <table class="w-full text-left text-sm border-collapse">
            <thead>
              <tr class="border-b border-gray-700 text-gray-400">
                <th class="py-2 pr-2">Name</th>
                <th class="py-2 pr-2">Coordinator</th>
                <th class="py-2 pr-2">Status</th>
              </tr>
            </thead>
            <tbody>
              <% if (clubs && clubs.length) { %>
                <% clubs.forEach(club => { %>
                  <tr class="border-b border-gray-800">
                    <td class="py-2 pr-2 font-medium"><%= club.name %></td>
                    <td class="py-2 pr-2">
                      <% if (club.coordinator) { %>
                        <%= club.coordinator.name %> (<%= club.coordinator.email %>)
                      <% } else { %>
                        <span class="text-gray-400">Not assigned</span>
                      <% } %>
                    </td>
                    <td class="py-2 pr-2">
                      <% if (club.isApproved) { %>
                        <span class="text-green-400 text-xs font-semibold px-2 py-1 rounded-full bg-green-900/30 border border-green-700/60">
                          Approved
                        </span>
                      <% } else { %>
                        <div class="flex items-center gap-2">
                          <span class="text-yellow-300 text-xs font-semibold px-2 py-1 rounded-full bg-yellow-900/30 border border-yellow-700/60">
                            Pending
                          </span>
                          <form action="/superadmin/clubs/<%= club._id %>/approve" method="POST">
                            <button
                              type="submit"
                              class="text-xs px-2 py-1 rounded bg-green-600 hover:bg-green-700 font-semibold"
                            >
                              Approve
                            </button>
                          </form>
                        </div>
                      <% } %>
                    </td>
                  </tr>
                <% }); %>
              <% } else { %>
                <tr>
                  <td colspan="3" class="py-4 text-center text-gray-400">
                    No clubs created yet.
                  </td>
                </tr>
              <% } %>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Coordinators table -->
      <div class="bg-gray-900 border border-gray-800 rounded-xl p-4">
        <div class="flex items-center justify-between mb-3">
          <h2 class="text-xl font-semibold">Coordinators</h2>
        </div>
        <div class="overflow-x-auto">
          <table class="w-full text-left text-sm border-collapse">
            <thead>
              <tr class="border-b border-gray-700 text-gray-400">
                <th class="py-2 pr-2">Name</th>
                <th class="py-2 pr-2">Email</th>
                <th class="py-2 pr-2">Club</th>
              </tr>
            </thead>
            <tbody>
              <% if (coordinators && coordinators.length) { %>
                <% coordinators.forEach(coord => { %>
                  <tr class="border-b border-gray-800">
                    <td class="py-2 pr-2 font-medium"><%= coord.name %></td>
                    <td class="py-2 pr-2"><%= coord.email %></td>
                    <td class="py-2 pr-2">
                      <% if (coord.club) { %>
                        <%= coord.club.name %>
                      <% } else { %>
                        <span class="text-gray-400">Not linked</span>
                      <% } %>
                    </td>
                  </tr>
                <% }); %>
              <% } else { %>
                <tr>
                  <td colspan="3" class="py-4 text-center text-gray-400">
                    No coordinators created yet.
                  </td>
                </tr>
              <% } %>
            </tbody>
          </table>
        </div>
      </div>

    </section>

    <!-- Forms: Create Club and Create Coordinator -->
    <section class="grid grid-cols-1 lg:grid-cols-2 gap-8">

      <!-- Create Club -->
      <div class="bg-gray-900 border border-gray-800 rounded-xl p-4">
        <h2 class="text-lg font-semibold mb-4">Create New Club</h2>
        <form action="/superadmin/clubs" method="POST" class="space-y-4">
          <div>
            <label class="block mb-1 text-sm text-gray-300">Club Name</label>
            <input
              type="text"
              name="name"
              required
              class="w-full px-3 py-2 rounded bg-gray-800 border border-gray-700 focus:outline-none focus:ring-1 focus:ring-green-500"
            />
          </div>
          <div>
            <label class="block mb-1 text-sm text-gray-300">Description</label>
            <textarea
              name="description"
              rows="3"
              class="w-full px-3 py-2 rounded bg-gray-800 border border-gray-700 focus:outline-none focus:ring-1 focus:ring-green-500"
            ></textarea>
          </div>
          <button
            type="submit"
            class="w-full py-2 rounded bg-green-600 hover:bg-green-700 font-semibold"
          >
            Create Club
          </button>
        </form>
      </div>

      <!-- Create Coordinator -->
      <div class="bg-gray-900 border border-gray-800 rounded-xl p-4">
        <h2 class="text-lg font-semibold mb-4">Create Coordinator Account</h2>
        <form action="/superadmin/coordinators" method="POST" class="space-y-4">
          <div>
            <label class="block mb-1 text-sm text-gray-300">Name</label>
            <input
              type="text"
              name="name"
              required
              class="w-full px-3 py-2 rounded bg-gray-800 border border-gray-700 focus:outline-none focus:ring-1 focus:ring-green-500"
            />
          </div>
          <div>
            <label class="block mb-1 text-sm text-gray-300">Email</label>
            <input
              type="email"
              name="email"
              required
              class="w-full px-3 py-2 rounded bg-gray-800 border border-gray-700 focus:outline-none focus:ring-1 focus:ring-green-500"
            />
          </div>
          <div>
            <label class="block mb-1 text-sm text-gray-300">Assign Club</label>
            <select
              name="clubId"
              required
              class="w-full px-3 py-2 rounded bg-gray-800 border border-gray-700 focus:outline-none focus:ring-1 focus:ring-green-500"
            >
              <option value="">Select a club</option>
              <% if (clubs && clubs.length) { %>
                <% clubs.forEach(club => { %>
                  <option value="<%= club._id %>"><%= club.name %></option>
                <% }); %>
              <% } %>
            </select>
          </div>
          <button
            type="submit"
            class="w-full py-2 rounded bg-blue-600 hover:bg-blue-700 font-semibold"
          >
            Create Coordinator
          </button>
        </form>
      </div>

    </section>

  </main>
</body>
</html>
